<!DOCTYPE html><html lang="es"><head><title>Alfonso Miranda - Mobile Software Engineer</title><meta name="twitter:title" content="Alfonso Miranda - Mobile Software Engineer"/><meta name="og:title" content="Alfonso Miranda - Mobile Software Engineer"/><meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/pure-min.css" integrity="sha384-oAOxQR6DkCoMliIh8yFnu25d7Eq/PHS21PClpwjOTeU2jRSq11vu66rf90/cZr47" crossorigin="anonymous"/><link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/grids-responsive-min.css"/><link rel="stylesheet" href="/Pure/styles.css"/><link rel="stylesheet" href="/all.css"/></head><body><div id="layout" class="pure-g"><div><div class="pure-menu pure-menu-horizontal pure-u-1-1 top-header"><ul class="pure-menu-list"><li class="pure-menu-item"><a class="pure-menu-link" href="/about">Sobre mi</a></li></ul></div></div><div class="sidebar pure-u-1 pure-u-md-1-4"><div class="header"><div id="layout" class="pure-g"><div class="pure-u-md-1-1 pure-u-3-4"><h1><a class="brand-title" href="/">Alfonso Miranda</a></h1><h3 class="brand-tagline">Mobile Software Engineer</h3></div></div><div id="layout" class="pure-g"><div class="pure-u-md-1-1"><a href="https://www.linkedin.com/in/alfonsomirandacastro/"><i class="fab fa-linkedin l-box social-icon"></i><a class="social-media" href="https://www.linkedin.com/in/alfonsomirandacastro/">LinkedIn</a></a></div><div class="pure-u-md-1-1"><a href="https://github.com/alfonsomiranda"><i class="fab fa-github-square l-box social-icon"></i><a class="social-media" href="https://github.com/alfonsomiranda">GitHub</a></a></div><div class="pure-u-md-1-1"><a href="https://twitter.com/alfonsobeta"><i class="fab fa-twitter-square l-box social-icon"></i><a class="social-media" href="https://twitter.com/alfonsobeta">Twitter</a></a></div><div class="pure-u-md-1-1"><a href="https://twitch.alfonsomiranda.com"><i class="fab fa-twitch l-box social-icon"></i><a class="social-media" href="https://twitch.alfonsomiranda.com">Twitch</a></a></div></div></div></div><div class="content pure-u-1 pure-u-md-3-5 pure-u-xl-6-10"><h2 class="post-title"><a href="/posts/component-swift-package-manager">Distribuye componentes con Swift Package Manager</a></h2><p class="post-meta">13 de octubre de 2021</p><div class="post-tags"><a class="post-category post-category-swift" href="/tags/swift">swift</a><a class="post-category post-category-swift package manager" href="/tags/swift-package-manager">swift package manager</a><a class="post-category post-category-spm" href="/tags/spm">spm</a><a class="post-category post-category-framework" href="/tags/framework">framework</a><a class="post-category post-category-library" href="/tags/library">library</a></div><div class="post-description"><div><p>Swift Package Manager es una herramienta para controlar la distribución de código Swift en forma de librería o framework. Está integrada con el sistema de compliación de Swift para automatizar el proceso de descarga, compilación y dependencias. En este artículo me gustaría comentar el proceso, muy simple, de poder crearte un componente en Swift para ser distribuido con Swift Package Manager.</p><h1>Creando un nuevo paquete</h1><p>La forma de crear un nuevo paquete es muy fácil. En primer lugar creamos un nuevo package de la siguiente forma:</p><img src="/images/spm/new-package.png" alt="New package" width="800"/><p>Le ponemos un nombre y se crea un proyecto de tipo SPM.</p><p>Una de las diferencias que tiene este tipo de proyecto es que no te crea un xcodeproj, si no que se abre con Package.swift. De todas formas, se puede crear ese xcodeproj por si nos es necesario, aunque no lo veremos en este artículo si lo haremos en uno próximo para ayudarnos con otras herramientas.</p><p>La estructura del proyecto queda de la siguiente forma.</p><img src="/images/spm/new-project-created.png" alt="New project" width="800"/><p>Tenemos el fichero Package.swift, donde tenemos la configuración del proyecto, si necesitamos alguna otra dependencia, targets de test. Por ahora no vamos a tocar este fichero.</p><p>Y después en Sources tendremos los ficheros de nuestro framework, con uno creado por defecto.</p><p>Como vemos en ese archivo, todo lo que hay declarado es público, y es muy importante que todo lo queramos "exponer" y que sea consumido los proyectos donde integremos nuestra librería tiene que ser public.</p><p>Vamos a hacer un cambio en este archivo para poner un método estático que simplemente imprima un Hello + name de la siguiente forma:</p><pre><code><span class="keyword">public struct</span> Matrix {
    <span class="keyword">public static func</span> hello(name: <span class="type">String</span>) -&gt; <span class="type">String</span> {
        <span class="keyword">return</span> <span class="string">"Hello "</span> + name
    }
}
</code></pre><p>Modificamos también los tests para que los pase:</p><pre><code><span class="keyword">import</span> XCTest
<span class="keyword">@testable import</span> Matrix

<span class="keyword">final class</span> MatrixTests: <span class="type">XCTestCase</span> {
    <span class="keyword">func</span> testHello() <span class="keyword">throws</span> {
        <span class="call">XCTAssertEqual</span>(<span class="type">Matrix</span>.<span class="call">hello</span>(name: <span class="string">"Alfonso"</span>), <span class="string">"Hello Alfonso"</span>)
    }
}
</code></pre><h1>Subiendo el proyecto a un repositorio</h1><p>Y con esto vamos a subir a nuestro repositorio para ver como se puede distribuir por SPM. Hay que tener cuidado de subir el proyecto a la raiz de nuestro repositorio para que lo podamos consumir.</p><p>Una vez subido creamos un tag de la siguiente forma, por consola.</p><pre><code>git tag -a <span class="number">1.0.0</span> -m <span class="string">"First version"</span>

git push origin <span class="number">1.0.0</span>
</code></pre><p>Y veremos en el repositorio que se ha creado.</p><img src="/images/spm/github-tag.png" alt="Github tag" width="800"/><p>Con esto ya lo tendríamos todo preparado para distribuirlo y consumirlo, no necesitamos nada más, vamos a ver como lo hacemos desde otro proyecto cualquiera.</p><h1>Usando la librería</h1><p>En el proyecto que queramos, vamos a File → Add Packages...</p><img src="/images/spm/add-packages.png" alt="Add package" width="800"/><p>Con esto ya lo tendríamos todo preparado para distribuirlo y consumirlo, no necesitamos nada más, vamos a ver como lo hacemos desde otro proyecto cualquiera.</p><p>En el proyecto que queramos, vamos a File → Add Packages...</p><img src="/images/spm/configure-package.png" alt="Configure package" width="800"/><p>Por defecto la regla de dependencia la tenemos como que se actualice solo cuando haya una versión major, pero podemos cambiarlo a minor, una versión en concreto, un rango de versiones e incluso una rama o un commit. Yo lo voy a dejar a que se actualice cada nueva minor version.</p><p>Le damos a añadir el paquete y nos muestra los paquetes disponibles y lo seleccionamos.</p><img src="/images/spm/select-package.png" alt="Select package" width="800"/><p>Y ya lo tendremos en nuestro proyecto.</p><img src="/images/spm/package-inserted.png" alt="Package inserted" width="260" height="238"/><p>Ahora, donde lo queramos usar, importamos el paquete.</p><pre><code><span class="keyword">import</span> Matrix
</code></pre><p>Y usamos el método que creamos, por ejemplo en un label en SwiftUI de la siguiente forma:</p><img src="/images/spm/use-package.png" alt="How use package" width="800"/><p>Y de esta forma ya lo estamos usando en nuestro proyecto. A partir de aquí, si tenemos que hacer cualquier actualización de este componente en concreto, lo podremos hacer de forma totalmente separada y distribuirla cuando esté terminada, teniendo la opción los proyectos que la usen de actualizarse cuando esté lista la nueva versión.</p><p>Próximamente, partiendo de este comienzo, hablaremos de como hacer una distribución más automatizada, ¡estad atentos!</p></div></div></div><div class="footer pure-u-1"><div class="pure-u-1">© 2021 Alfonso Miranda</div><div class="pure-u-1">Generated using <a href="https://github.com/johnsundell/publish">Publish</a>. Written in Swift</div><div class="pure-u-1"><a href="/feed.rss">RSS feed</a></div></div></div></body></html>